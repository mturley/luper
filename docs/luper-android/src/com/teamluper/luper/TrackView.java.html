<!DOCTYPE html><html><head><title>TrackView.java</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestSQLiteDataSource.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestSQLiteDataSource.java</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestTrack.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestTrack.java</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestClip.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestClip.java</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestSequence.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestSequence.java</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestAudioFile.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestAudioFile.java</span></a><a href="../../../../../TestLuper/src/com/teamluper/luper/test/TestUser.java.html" class="source "><span class="base_path">TestLuper / src / com / teamluper / luper / test / </span><span class="file_name">TestUser.java</span></a><a href="../../../../../luper-android/src/com/androidlearner/widget/DragThingPlayhead.java.html" class="source "><span class="base_path">luper-android / src / com / androidlearner / widget / </span><span class="file_name">DragThingPlayhead.java</span></a><a href="../../../../../luper-android/src/com/androidlearner/widget/DragThing.java.html" class="source "><span class="base_path">luper-android / src / com / androidlearner / widget / </span><span class="file_name">DragThing.java</span></a><a href="../../../../../luper-android/src/com/androidlearner/widget/ClipThing.java.html" class="source "><span class="base_path">luper-android / src / com / androidlearner / widget / </span><span class="file_name">ClipThing.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/PopupTestActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">PopupTestActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperProjectEditorActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperProjectEditorActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/Sequence.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">Sequence.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabProjectsFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabProjectsFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/Clip.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">Clip.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/Track.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">Track.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/CanvasTestActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">CanvasTestActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/AudioRecorderTestActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">AudioRecorderTestActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperForgotPasswordActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperForgotPasswordActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/DragThing.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">DragThing.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabLoginFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabLoginFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/DialogFactory.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">DialogFactory.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/SQLiteHelper.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">SQLiteHelper.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/User.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">User.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/FileSelectorActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">FileSelectorActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperMainActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperMainActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/Playhead.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">Playhead.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/Lambda.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">Lambda.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LoopTestActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LoopTestActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabFriendsFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabFriendsFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/ColorChipButton.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">ColorChipButton.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperLoginActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperLoginActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TrackView.java.html" class="source selected"><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TrackView.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabSplashFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabSplashFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperDevToolsActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperDevToolsActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/DragTest.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">DragTest.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperHelp.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperHelp.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabHomeFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabHomeFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/AudioFile.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">AudioFile.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabsAdapter.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabsAdapter.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/LuperSettingsActivity.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">LuperSettingsActivity.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/TabRegisterFragment.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">TabRegisterFragment.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/rest/LuperRestClient.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / rest / </span><span class="file_name">LuperRestClient.java</span></a><a href="../../../../../luper-android/src/com/teamluper/luper/SQLiteDataSource.java.html" class="source "><span class="base_path">luper-android / src / com / teamluper / luper / </span><span class="file_name">SQLiteDataSource.java</span></a><a href="../../../../../luper-web/dashboard/js/main.js.html" class="source "><span class="base_path">luper-web / dashboard / js / </span><span class="file_name">main.js</span></a><a href="../../../../../luper-web/dashboard/js/vendor/bootstrap.min.js.html" class="source "><span class="base_path">luper-web / dashboard / js / vendor / </span><span class="file_name">bootstrap.min.js</span></a><a href="../../../../../luper-web/dashboard/js/vendor/jquery-1.9.1.min.js.html" class="source "><span class="base_path">luper-web / dashboard / js / vendor / </span><span class="file_name">jquery-1.9.1.min.js</span></a><a href="../../../../../luper-web/dashboard/js/vendor/bootstrap.js.html" class="source "><span class="base_path">luper-web / dashboard / js / vendor / </span><span class="file_name">bootstrap.js</span></a><a href="../../../../../luper-web/dashboard/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js.html" class="source "><span class="base_path">luper-web / dashboard / js / vendor / </span><span class="file_name">modernizr-2.6.2-respond-1.1.0.min.js</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>TrackView.java</h1><div class="filepath">luper-android/src/com/teamluper/luper/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">teamluper</span><span class="o">.</span><span class="na">luper</span><span class="o">;</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Copyright (C) 2011 The Android Open Source Project</p></div><div class="body"><p>Licensed under the Apache License, Version 2.0 (the "License");<br />you may not use this file except in compliance with the License.<br />You may obtain a copy of the License at</p>

<pre><code> <a href='http://www.apache.org/licenses/LICENSE-2.0'>http://www.apache.org/licenses/LICENSE-2.0</a>
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software<br />distributed under the License is distributed on an "AS IS" BASIS,<br />WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br />See the License for the specific language governing permissions and<br />limitations under the License.</p></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">android.app.AlertDialog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.DialogInterface</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Bitmap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.BitmapFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Color</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Shader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.drawable.BitmapDrawable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.media.MediaPlayer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.media.MediaRecorder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Environment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Looper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.ViewGroup</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View.OnClickListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.androidlearner.widget.DragThing</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.androidlearner.widget.DragThingPlayhead</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.googlecode.androidannotations.annotations.Background</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.googlecode.androidannotations.annotations.EView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.googlecode.androidannotations.annotations.UiThread</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.teamluper.luper.AudioRecorderTestActivity.PlayButton</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.teamluper.luper.AudioRecorderTestActivity.playTrackButton</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.actionbarsherlock.app.SherlockActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.androidlearner.widget.DragThingPlayhead</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.googlecode.androidannotations.annotations.EActivity</span><span class="o">;</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>A custom view for a color chip for an event that can be drawn differently<br />according to the event's status.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nd">@EView</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TrackView</span> <span class="kd">extends</span> <span class="n">RelativeLayout</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">LOG_TAG</span> <span class="o">=</span> <span class="s">&quot;TrackView&quot;</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">float</span> <span class="n">PIXELS_PER_MILLISECOND</span> <span class="o">=</span> <span class="mf">0.3f</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LEFT_MARGIN</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>

  <span class="n">DragThing</span> <span class="n">deMovingTxt</span><span class="o">;</span>
  <span class="kt">int</span> <span class="o">[]</span> <span class="n">paramz</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">lastRecordedFileName</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">AudioFile</span> <span class="n">lastRecordedFile</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">RecordButton</span> <span class="n">mRecordButton</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">MediaRecorder</span> <span class="n">mRecorder</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">PlayButton</span>   <span class="n">mPlayButton</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">MediaPlayer</span>   <span class="n">mPlayer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">Button</span> <span class="n">mBrowseButton</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">TextView</span> <span class="n">fileSelected</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">DragThingPlayhead</span> <span class="n">playhead</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">MediaFetchResultCode</span> <span class="o">=</span> <span class="mi">11</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">SQLiteDataSource</span> <span class="n">dataSource</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">Clip</span> <span class="n">newClip</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">Clip</span> <span class="n">preparedClip</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="n">Track</span> <span class="n">associated</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="n">startTimeSetter</span><span class="o">;</span>

  <span class="kd">private</span> <span class="n">LuperProjectEditorActivity</span> <span class="n">editorActivity</span><span class="o">;</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>the track that will be associated with this TrackView
Track associated;</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>constructor</p>
</td><td class="code"><div class="highlight"><pre>  <span class="kd">public</span> <span class="nf">TrackView</span><span class="o">(</span><span class="n">LuperProjectEditorActivity</span> <span class="n">context</span><span class="o">,</span> <span class="n">Track</span> <span class="n">track</span><span class="o">,</span> <span class="n">SQLiteDataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="n">editorActivity</span> <span class="o">=</span> <span class="n">context</span><span class="o">;</span>
    <span class="n">playhead</span> <span class="o">=</span> <span class="o">(</span><span class="n">DragThingPlayhead</span><span class="o">)</span><span class="n">editorActivity</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="mi">1337</span><span class="o">);</span>
    <span class="n">associated</span> <span class="o">=</span> <span class="n">track</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">dataSource</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">;</span>
    <span class="n">deMovingTxt</span> <span class="o">=</span> <span class="o">(</span><span class="n">DragThing</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">detext</span><span class="o">);</span>
    <span class="n">init</span><span class="o">();</span>
  <span class="o">}</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>set a click listener for the buttons that will activate promptDialog() when clicked</p>
</td><td class="code"><div class="highlight"><pre>  <span class="n">OnClickListener</span> <span class="n">addClipClicker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OnClickListener</span><span class="o">(){</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">){</span>
      <span class="n">addClipPromptDialog</span><span class="o">();</span> <span class="c1">// later on this will be the time corresponding to where in the empty timeline we touched.</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>TODO</p>
</td><td class="code"><div class="highlight"><pre>    <span class="o">}</span>
  <span class="o">};</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>TODO: Implement the listener for the play button, so we can play a track</p>
</td><td class="code"><div class="highlight"><pre>  <span class="n">OnClickListener</span> <span class="n">playClicker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OnClickListener</span><span class="o">(){</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">){</span>
      <span class="n">startPlayingTrack</span><span class="o">();</span> <span class="c1">//need track startPlayback but track class + audio hook-up not working yet; this does work though</span>
    <span class="o">}</span>
  <span class="o">};</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>listener for the browse button in the record or browse alertdialog</p>
</td><td class="code"><div class="highlight"><pre>  <span class="n">OnClickListener</span> <span class="n">browseClicker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OnClickListener</span><span class="o">(){</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">){</span>
      <span class="n">browsePromptDialog</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">};</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">init</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@UiThread</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(){</span>
    <span class="n">mPlayer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaPlayer</span><span class="o">();</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(
       LinearLayout.LayoutParams.FILL<em>PARENT, LinearLayout.LayoutParams.WRAP</em>CONTENT);
layoutParams.setMargins(5, 0, 5, 0);
this.setLayoutParams(layoutParams);</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><pre><code>add a linear layout to the left side that will have a playtrack button
as well as a button to add a clip to this track
</code></pre>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getChildCount</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">removeAllViews</span><span class="o">();</span>

    <span class="n">LinearLayout</span> <span class="n">trackControl</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">trackControl</span><span class="o">.</span><span class="na">setOrientation</span><span class="o">(</span><span class="n">LinearLayout</span><span class="o">.</span><span class="na">VERTICAL</span><span class="o">);</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>wai doesnt this werrrkk???
deMovingTxt = (DragThing) findViewById(R.id.detext);
this.addView(deMovingTxt);</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><pre><code>create the addClipButton then set its image to add and add it to the trackControl
</code></pre>
</td><td class="code"><div class="highlight"><pre>    <span class="n">ImageButton</span> <span class="n">addClipButton</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageButton</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">addClipButton</span><span class="o">.</span><span class="na">setImageResource</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">add</span><span class="o">);</span>
    <span class="n">addClipButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="n">addClipClicker</span><span class="o">);</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>addClipButton.setBackgroundColor(Color.parseColor("#f5f5f5"));</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">trackControl</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">addClipButton</span><span class="o">);</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><pre><code>create the playButton then set its image to play and add it to the trackControl
</code></pre>
</td><td class="code"><div class="highlight"><pre>    <span class="n">ImageButton</span> <span class="n">playButton</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageButton</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">playButton</span><span class="o">.</span><span class="na">setImageResource</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">play</span><span class="o">);</span>
    <span class="n">playButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="n">playClicker</span><span class="o">);</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><p>playButton.setBackgroundColor(Color.parseColor("#f5f5f5"));</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">trackControl</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">playButton</span><span class="o">);</span>

    <span class="n">trackControl</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">parseColor</span><span class="o">(</span><span class="s">&quot;#f5f5f5&quot;</span><span class="o">));</span>


    <span class="k">this</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">trackControl</span><span class="o">);</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><pre><code>testing...
</code></pre>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>Clip clip1 = new Clip(); clip1.begin = 100; clip1.end = 4000; clip1.duration = 3900;
Clip clip2 = new Clip(); clip2.begin = 0; clip2.end = 450; clip2.duration = 450;</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">ColorChipButton</span> <span class="n">chip</span><span class="o">;</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><p>this.associated.putClip(clip1);
this.associated.putClip(clip2);</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
      <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">MATCH_PARENT</span><span class="o">,</span> <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">MATCH_PARENT</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">setLayoutParams</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>

    <span class="k">for</span><span class="o">(</span><span class="n">Clip</span> <span class="n">c</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">associated</span><span class="o">.</span><span class="na">clips</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">chip</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ColorChipButton</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">(),</span> <span class="n">c</span><span class="o">);</span>
      <span class="n">c</span><span class="o">.</span><span class="na">addAssociatedView</span><span class="o">(</span><span class="n">chip</span><span class="o">);</span>
      <span class="k">this</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">chip</span><span class="o">);</span>
      <span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getLoopCount</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">c</span><span class="o">.</span><span class="na">getLoopCount</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
          <span class="n">ColorChipButton</span> <span class="n">loopChip</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ColorChipButton</span><span class="o">(</span><span class="n">getContext</span><span class="o">(),</span> <span class="n">c</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
          <span class="k">this</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">loopChip</span><span class="o">);</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>Creates the dialog for record or browse, for adding clips to tracks,</p>
</td><td class="code"><div class="highlight"><pre>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addClipPromptDialog</span><span class="o">(){</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><p>our custom layout for inside the dialog</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">LinearLayout</span> <span class="n">custom</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">custom</span><span class="o">.</span><span class="na">setOrientation</span><span class="o">(</span><span class="n">LinearLayout</span><span class="o">.</span><span class="na">VERTICAL</span><span class="o">);</span>

    <span class="n">LinearLayout</span> <span class="n">ll</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">mRecordButton</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RecordButton</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">ll</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">mRecordButton</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="mi">0</span><span class="o">));</span>

    <span class="n">LinearLayout</span> <span class="n">ll2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">mBrowseButton</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">mBrowseButton</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;Browse&quot;</span><span class="o">);</span>
    <span class="n">mBrowseButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="n">browseClicker</span><span class="o">);</span>
    <span class="n">fileSelected</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AutoCompleteTextView</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">fileSelected</span><span class="o">.</span><span class="na">setHint</span><span class="o">(</span><span class="s">&quot;Select a File&quot;</span><span class="o">);</span>
    <span class="n">ll2</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">mBrowseButton</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="mi">0</span><span class="o">));</span>
    <span class="n">ll2</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">fileSelected</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">FILL_PARENT</span><span class="o">,</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">FILL_PARENT</span><span class="o">,</span>
            <span class="mi">0</span><span class="o">));</span>

    <span class="n">custom</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">ll</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="mi">0</span><span class="o">));</span>
    <span class="n">custom</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">ll2</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">LinearLayout</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">(</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">MATCH_PARENT</span><span class="o">,</span>
            <span class="n">ViewGroup</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">WRAP_CONTENT</span><span class="o">,</span>
            <span class="mi">0</span><span class="o">));</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><p>final int finalStartTime = startTime;</p>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">final</span> <span class="n">Track</span> <span class="n">finalTrack</span> <span class="o">=</span> <span class="n">associated</span><span class="o">;</span>

    <span class="k">new</span> <span class="n">AlertDialog</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">getContext</span><span class="o">())</span>
      <span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&quot;Record or Browse?&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setView</span><span class="o">(</span><span class="n">custom</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setPositiveButton</span><span class="o">(</span><span class="s">&quot;Ok&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">whichButton</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><p>want it to pass a new clip back to the editor panel and add it to the screen
startTimePrompt(finalStartTime);</p>
</td><td class="code"><div class="highlight"><pre>          <span class="n">startTimePrompt</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">})</span>
      <span class="o">.</span><span class="na">setNegativeButton</span><span class="o">(</span><span class="s">&quot;Cancel&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">whichButton</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>Do nothing.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="o">}</span>
      <span class="o">})</span>
      <span class="o">.</span><span class="na">show</span><span class="o">();</span>
  <span class="o">}</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><p>creates a dialog for browsing a list of the user's audiofiles, for adding clips to a track with a file youve already
recorded.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">browsePromptDialog</span><span class="o">(){</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Here&quot;</span><span class="o">);</span>
    <span class="kd">final</span> <span class="n">AudioFile</span><span class="o">[]</span> <span class="n">audioFilesByUser</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">dataSource</span><span class="o">.</span><span class="na">getAudioFilesByUserId</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">dataSource</span><span class="o">.</span><span class="na">getActiveUser</span><span class="o">().</span><span class="na">getId</span><span class="o">());</span>
    <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">fileNames</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">audioFilesByUser</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">audioFilesByUser</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
      <span class="n">fileNames</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">audioFilesByUser</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getClientFilePath</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">new</span> <span class="n">AlertDialog</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">getContext</span><span class="o">())</span>
        <span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&quot;Select Audio File for New Clip Homie&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">fileNames</span><span class="o">,</span> <span class="k">new</span> <span class="n">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><p>The 'which' argument contains the index position
of the selected item</p>
</td><td class="code"><div class="highlight"><pre>            <span class="n">lastRecordedFile</span> <span class="o">=</span> <span class="n">audioFilesByUser</span><span class="o">[</span><span class="n">which</span><span class="o">];</span>
            <span class="n">fileSelected</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lastRecordedFile</span><span class="o">.</span><span class="na">getClientFilePath</span><span class="o">());</span>
          <span class="o">}</span>
        <span class="o">})</span>
        <span class="o">.</span><span class="na">show</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setStart</span><span class="o">(</span><span class="kt">int</span> <span class="n">time</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">startTimeSetter</span> <span class="o">=</span> <span class="n">time</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isNumeric</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">&quot;[-+]?\\d*\\.?\\d+&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startTimePrompt</span><span class="o">(){</span>
    <span class="n">DialogFactory</span><span class="o">.</span><span class="na">prompt</span><span class="o">(</span><span class="n">getContext</span><span class="o">(),</span> <span class="s">&quot;Enter a start time or add it to the end of the track by entering nothing.&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">Lambda</span><span class="o">.</span><span class="na">StringCallback</span><span class="o">()</span> <span class="o">{</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">go</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
              <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">associated</span><span class="o">.</span><span class="na">findLastClipTime</span><span class="o">()</span> <span class="o">+</span> <span class="mi">25</span><span class="o">;</span>
              <span class="n">clipMaker</span><span class="o">(</span><span class="n">associated</span><span class="o">,</span> <span class="n">lastRecordedFile</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">isNumeric</span><span class="o">(</span><span class="n">value</span><span class="o">))</span> <span class="o">{</span>
              <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
              <span class="n">clipMaker</span><span class="o">(</span><span class="n">associated</span><span class="o">,</span> <span class="n">lastRecordedFile</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
              <span class="n">DialogFactory</span><span class="o">.</span><span class="na">alert</span><span class="o">(</span><span class="n">getContext</span><span class="o">(),</span> <span class="s">&quot;Oops!&quot;</span><span class="o">,</span> <span class="s">&quot;That isn&#39;t a valid start time.&quot;</span><span class="o">);</span>
            <span class="o">}</span>
          <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clipMaker</span><span class="o">(</span><span class="n">Track</span> <span class="n">track</span><span class="o">,</span> <span class="n">AudioFile</span> <span class="n">file</span><span class="o">,</span> <span class="kt">int</span> <span class="n">startTime</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Random</span> <span class="n">rnd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">newColor</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">argb</span><span class="o">(</span><span class="mi">168</span><span class="o">,</span> <span class="n">rnd</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">256</span><span class="o">),</span> <span class="n">rnd</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">256</span><span class="o">),</span> <span class="n">rnd</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">256</span><span class="o">));</span>
    <span class="n">Clip</span> <span class="n">newClip</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">.</span><span class="na">createClip</span><span class="o">(</span><span class="n">track</span><span class="o">,</span> <span class="n">file</span><span class="o">,</span> <span class="n">startTime</span><span class="o">,</span> <span class="n">newColor</span><span class="o">);</span>
    <span class="n">newClip</span><span class="o">.</span><span class="na">parentTrack</span> <span class="o">=</span> <span class="n">track</span><span class="o">;</span>
    <span class="n">track</span><span class="o">.</span><span class="na">clips</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newClip</span><span class="o">);</span>
    <span class="n">ColorChipButton</span> <span class="n">newButton</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ColorChipButton</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">(),</span> <span class="n">newClip</span><span class="o">);</span>
    <span class="n">newClip</span><span class="o">.</span><span class="na">addAssociatedView</span><span class="o">(</span><span class="n">newButton</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">addView</span><span class="o">(</span><span class="n">newButton</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">invalidateSafely</span><span class="o">();</span>
  <span class="o">}</span>


  <span class="kd">class</span> <span class="nc">RecordButton</span> <span class="kd">extends</span> <span class="n">Button</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">mStartRecording</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>

    <span class="n">OnClickListener</span> <span class="n">clicker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">onRecord</span><span class="o">(</span><span class="n">mStartRecording</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">mStartRecording</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">setText</span><span class="o">(</span><span class="s">&quot;Stop recording&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
          <span class="n">setText</span><span class="o">(</span><span class="s">&quot;Start recording&quot;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">mStartRecording</span> <span class="o">=</span> <span class="o">!</span><span class="n">mStartRecording</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">};</span>

    <span class="kd">public</span> <span class="nf">RecordButton</span><span class="o">(</span><span class="n">Context</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">{</span>
      <span class="kd">super</span><span class="o">(</span><span class="n">ctx</span><span class="o">);</span>
      <span class="n">setText</span><span class="o">(</span><span class="s">&quot;Start recording&quot;</span><span class="o">);</span>
      <span class="n">setOnClickListener</span><span class="o">(</span><span class="n">clicker</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">onRecord</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">start</span><span class="o">)</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">start</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">startRecording</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">stopRecording</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">startRecording</span><span class="o">()</span> <span class="o">{</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><p>Sets the name of the file when you start recording as opposed to when you click "Audio Record Test" from the main screen</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">lastRecordedFileName</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="na">getExternalStorageDirectory</span><span class="o">()+</span><span class="s">&quot;/LuperApp/Clips&quot;</span><span class="o">;</span>
    <span class="n">lastRecordedFileName</span> <span class="o">+=</span> <span class="s">&quot;/clip_&quot;</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="o">+</span><span class="s">&quot;.3gp&quot;</span><span class="o">;</span>

    <span class="n">mRecorder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaRecorder</span><span class="o">();</span>
    <span class="n">mRecorder</span><span class="o">.</span><span class="na">setAudioSource</span><span class="o">(</span><span class="n">MediaRecorder</span><span class="o">.</span><span class="na">AudioSource</span><span class="o">.</span><span class="na">MIC</span><span class="o">);</span>
    <span class="n">mRecorder</span><span class="o">.</span><span class="na">setOutputFormat</span><span class="o">(</span><span class="n">MediaRecorder</span><span class="o">.</span><span class="na">OutputFormat</span><span class="o">.</span><span class="na">THREE_GPP</span><span class="o">);</span>
    <span class="n">mRecorder</span><span class="o">.</span><span class="na">setOutputFile</span><span class="o">(</span><span class="n">lastRecordedFileName</span><span class="o">);</span>

    <span class="n">mRecorder</span><span class="o">.</span><span class="na">setAudioEncoder</span><span class="o">(</span><span class="n">MediaRecorder</span><span class="o">.</span><span class="na">AudioEncoder</span><span class="o">.</span><span class="na">AMR_NB</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="n">mRecorder</span><span class="o">.</span><span class="na">prepare</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">LOG_TAG</span><span class="o">,</span> <span class="s">&quot;prepare() failed&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">mRecorder</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">stopRecording</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">mRecorder</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
    <span class="n">mRecorder</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>

    <span class="n">lastRecordedFile</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">.</span><span class="na">createAudioFile</span><span class="o">(</span><span class="n">dataSource</span><span class="o">.</span><span class="na">getActiveUser</span><span class="o">(),</span> <span class="n">lastRecordedFileName</span><span class="o">);</span>
    <span class="n">lastRecordedFile</span><span class="o">.</span><span class="na">setReadyOnClient</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

    <span class="n">lastRecordedFile</span><span class="o">.</span><span class="na">setDurationMS</span><span class="o">(</span><span class="n">lastRecordedFile</span><span class="o">.</span><span class="na">calcDuration</span><span class="o">());</span>

    <span class="n">fileSelected</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lastRecordedFileName</span><span class="o">);</span>
    <span class="n">mRecorder</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="o">}</span></pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>rivate void startPlaying() {</p></div><div class="body"><pre><code>    mPlayer = new MediaPlayer();
    try {
        mPlayer.setDataSource(lastRecordedFileName);
        mPlayer.prepare();
        //playFrom(1000);
        mPlayer.start();
      editorActivity.playhead.moveHead(mPlayer);
    } catch (IOException e) {
        Log.e(LOG_TAG, "prepare() failed1");
    }
}
</code></pre>

<p>private void stopPlaying() {<br />      if(mPlayer != null) {<br />        mPlayer.release();<br />        mPlayer = null;<br />      }<br />    }</p></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nd">@Background</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">playPreparedClip</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">playPreparedClip</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
  <span class="o">}</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><p>plays the prepared clip immediately, without regard to timing.
since there is no timing logic in here, we must call it exactly when we want the clip to start.
this also sets up a listener for when the clip is finished playing, where it identifies and prepares the next clip.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nd">@Background</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">playPreparedClip</span><span class="o">(</span><span class="kd">final</span> <span class="n">Clip</span> <span class="n">optionalNextClip</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">preparedClip</span><span class="o">.</span><span class="na">resetLoop</span><span class="o">();</span>
      <span class="kd">final</span> <span class="n">Track</span> <span class="n">t</span> <span class="o">=</span> <span class="n">associated</span><span class="o">;</span>
      <span class="kd">final</span> <span class="n">Clip</span> <span class="n">justPlayedClip</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">preparedClip</span><span class="o">;</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">setOnCompletionListener</span><span class="o">(</span><span class="k">new</span> <span class="n">MediaPlayer</span><span class="o">.</span><span class="na">OnCompletionListener</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCompletion</span><span class="o">(</span><span class="n">MediaPlayer</span> <span class="n">mp</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><p>when a clip finishes playing, we check conditions to do a number of things:</p>
</td><td class="code"><div class="highlight"><pre>          <span class="k">if</span><span class="o">(</span><span class="n">justPlayedClip</span><span class="o">.</span><span class="na">getLoopCount</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">justPlayedClip</span><span class="o">.</span><span class="na">remainingLoops</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><p>if this is a loop which has more loops to go, decrement and start playing it again.+</p>
</td><td class="code"><div class="highlight"><pre>            <span class="n">justPlayedClip</span><span class="o">.</span><span class="na">remainingLoops</span><span class="o">--;</span>
            <span class="n">mp</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
          <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">optionalNextClip</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">t</span><span class="o">.</span><span class="na">nextClip</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><p>if there is no specific clip to prepare, just progress to the track's next clip.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="n">t</span><span class="o">.</span><span class="na">prepareNextClip</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">nextClip</span><span class="o">.</span><span class="na">getStartTime</span><span class="o">()+</span><span class="mi">10</span><span class="o">);</span>
          <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">optionalNextClip</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><p>if this was called with a specific next clip to prepare, prepare it.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="n">t</span><span class="o">.</span><span class="na">trackView</span><span class="o">.</span><span class="na">prepareClip</span><span class="o">(</span><span class="n">optionalNextClip</span><span class="o">);</span>
          <span class="o">}</span> <span class="k">else</span> <span class="o">{</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><p>we've played the last clip!</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span><span class="o">(</span><span class="n">justPlayedClip</span> <span class="o">==</span> <span class="n">editorActivity</span><span class="o">.</span><span class="na">veryLastClip</span><span class="o">)</span> <span class="o">{</span>
              <span class="o">((</span><span class="n">Playhead</span><span class="o">)</span> <span class="n">editorActivity</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="mi">1337</span><span class="o">)).</span><span class="na">stopPlayback</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
              <span class="n">editorActivity</span><span class="o">.</span><span class="na">supportInvalidateOptionsMenu</span><span class="o">();</span>
            <span class="o">}</span>
          <span class="o">}</span>
        <span class="o">}</span>
      <span class="o">});</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><p>handle interrupted exceptions in a different way</p>
</td><td class="code"><div class="highlight"><pre>      <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">LOG_TAG</span><span class="o">,</span> <span class="s">&quot;CLIP PREPARE FAILED&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@UiThread</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startPlayingTrack</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">startPlayingTrackInBackground</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Background</span> <span class="c1">// doesn&#39;t actually run them in parallel - might be related to the sleep call in track startPlayback</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startPlayingTrackInBackground</span><span class="o">()</span> <span class="o">{</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><p>mPlayer = new MediaPlayer();</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Clip</span><span class="o">&gt;</span> <span class="n">clips</span> <span class="o">=</span> <span class="n">associated</span><span class="o">.</span><span class="na">getClips</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">clips</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">Clip</span> <span class="n">c</span> <span class="o">=</span> <span class="n">clips</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
      <span class="n">prepareClip</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getDurationMS</span><span class="o">());</span>
      <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">&quot;luper&quot;</span><span class="o">,</span> <span class="s">&quot;THREAD.SLEEP WAS INTERRUPTED WHILE PLAYING INDIVIDUAL TRACK&quot;</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">playPreparedClip</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">clips</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">?</span> <span class="n">clips</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Background</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stopPlaying</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">mPlayer</span><span class="o">.</span><span class="na">isPlaying</span><span class="o">())</span> <span class="n">mPlayer</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Background</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">prepareClip</span><span class="o">(</span><span class="n">Clip</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">preparedClip</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">mPlayer</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">mPlayer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaPlayer</span><span class="o">();</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><p>mPlayer is now idle</p>
</td><td class="code"><div class="highlight"><pre>    <span class="n">String</span> <span class="n">clipFileName</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getAudioFile</span><span class="o">().</span><span class="na">getClientFilePath</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">clipFileName</span><span class="o">);</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">prepare</span><span class="o">();</span></pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><p>TODO make an onPrepared and check if we're behind playhead</p>
</td><td class="code"><div class="highlight"><pre>    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><p>handle interrupted exceptions in a different way</p>
</td><td class="code"><div class="highlight"><pre>      <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">LOG_TAG</span><span class="o">,</span> <span class="s">&quot;CLIP PREPARE FAILED&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">invalidateSafely</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">Looper</span><span class="o">.</span><span class="na">myLooper</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">Looper</span><span class="o">.</span><span class="na">myLooper</span><span class="o">()</span> <span class="o">==</span> <span class="n">Looper</span><span class="o">.</span><span class="na">getMainLooper</span><span class="o">())</span> <span class="o">{</span></pre></div></td></tr><tr id="section-40"><td class="docs"><div class="pilwrap"><a href="#section-40" class="pilcrow">&#182;</a></div><p>we're in the main-thread / UI Thread.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">this</span><span class="o">.</span><span class="na">invalidate</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span></pre></div></td></tr><tr id="section-41"><td class="docs"><div class="pilwrap"><a href="#section-41" class="pilcrow">&#182;</a></div><p>we're in a background thread.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">this</span><span class="o">.</span><span class="na">postInvalidate</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">stopPlayingTrack</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">mPlayer</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">mPlayer</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
      <span class="n">mPlayer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">MediaPlayer</span> <span class="nf">getMediaPlayer</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">mPlayer</span><span class="o">;</span>
  <span class="o">}</span>


<span class="o">}</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Thu May 02 2013 20:14:03 GMT+0000 (UTC)  </div><div id="projectname"><a href="../../../../../index.html">Lüper</a></div></div></body></html>